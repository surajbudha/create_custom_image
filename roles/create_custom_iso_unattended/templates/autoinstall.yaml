#cloud-config
#  This file was generated from a Jinja2 template.
#  Modify the template at roles/create_custom_iso_unattended/templates/autoinstall.yaml to make changes.

autoinstall:
  #apt:
  #  disable_components: []
  #  fallback: offline-install
  #  geoip: true
  #  mirror-selection:
  #    primary:
  #    - country-mirror
  #    - arches: &id001
  #      - amd64
  #      - i386
  #      uri: http://archive.ubuntu.com/ubuntu/
  #    - arches: &id002
  #      - s390x
  #      - arm64
  #      - armhf
  #      - powerpc
  #      - ppc64el
  #      - riscv64
  #      uri: http://ports.ubuntu.com/ubuntu-ports
  #  preserve_sources_list: false
  #  security:
  #  - arches: *id001
  #    uri: http://security.ubuntu.com/ubuntu/
  #  - arches: *id002
  #    uri: http://ports.ubuntu.com/ubuntu-ports
  #codecs:
  #  install: false
  #drivers:
  #  install: false
  identity:
    hostname: {{ defult_hostname }}
    password: {{ default_user_password }}
    realname: {{ default_name }}
    username: {{ default_user}}
  kernel:
    package: linux-generic
  keyboard:
    layout: de
    toggle: null
    variant: ''
  locale: en_US.UTF-8
  network:
    ethernets:
      enp1s0:
        addresses:
        - "{{ network_ip }}/{{ network_cidr }}"
        dhcp4: false
        dhcp6: false
        gateway4: {{ default_gateway }}
        nameservers:
          addresses:
          - 8.8.8.8
          - 8.8.4.4
          search: []
        routes:
        - to: default
          via: {{ default_gateway }}
    version: 2
  oem:
    install: auto
  source:
    id: ubuntu-server
    search_drivers: true
  ssh:
    allow-pw: true
    authorized-keys:  ["{{ default_ssh_public_key }}"]
    install-server: true
  storage:
    config:
    - ptable: gpt
      path: /dev/vda
      wipe: superblock
      preserve: false
      name: ''
      grub_device: true
      id: disk-vda
      type: disk
      wipe_table: true
    - device: disk-vda
      size: 1048576
      flag: bios_grub
      #number: 1
      #preserve: false
      #grub_device: false
      #offset: 1048576
      #path: /dev/vda1
      id: partition-0
      type: partition
    - device: disk-vda
      size: 21471690752
      wipe: superblock
      number: 2
      #preserve: false
      #grub_device: false
      #offset: 2097152
      #path: /dev/vda2
      id: partition-1
      type: partition
    - name: vg-sys
      devices:
      - partition-1
      preserve: false
      id: lvm_volgroup-0
      type: lvm_volgroup
    - name: lv-boot
      volgroup: lvm_volgroup-0
      size: {{ boot_size }}
      wipe: superblock
      preserve: false
      path: /dev/vg-sys/lv-boot
      id: lvm_partition-0
      type: lvm_partition
    - fstype: ext4
      volume: lvm_partition-0
      preserve: false
      id: format-1
      type: format
    - name: lv-swap
      volgroup: lvm_volgroup-0
      size: {{ swap_size }}
      wipe: superblock
      preserve: false
      path: /dev/vg-sys/lv-swap
      id: lvm_partition-1
      type: lvm_partition
    - fstype: swap
      volume: lvm_partition-1
      preserve: false
      id: format-2
      type: format
    - path: ''
      device: format-2
      id: mount-1
      type: mount
    - name: lv-root
      volgroup: lvm_volgroup-0
      size: -1
      wipe: superblock
      preserve: false
      path: /dev/vg-sys/lv-root
      id: lvm_partition-2
      type: lvm_partition
    - fstype: ext4
      volume: lvm_partition-2
      preserve: false
      id: format-3
      type: format
    - path: /
      device: format-3
      id: mount-2
      type: mount
    - path: /boot
      device: format-1
      id: mount-0
      type: mount
    swap:
      size: 0
  updates: security
  version: 1
